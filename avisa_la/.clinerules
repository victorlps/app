# REGRAS PARA IA - DESENVOLVIMENTO 100% ASSISTIDO POR IA

## ü§ñ CONTEXTO IMPORTANTE

O desenvolvedor **N√ÉO codifica diretamente**. Toda intera√ß√£o √© via IA.
- ‚úÖ A IA escreve 100% do c√≥digo
- ‚úÖ A IA executa comandos via terminal
- ‚úÖ A IA faz build, testes e debug
- ‚úÖ O desenvolvedor apenas valida resultados no S23

---

## üö® PROBLEMA CR√çTICO RESOLVIDO

**NUNCA interaja diretamente com o terminal do Flutter em execu√ß√£o!**

### ‚ùå O QUE CAUSA PERDA DE CONEX√ÉO:
- Enviar comandos ('r', 'R', 'q') para o terminal onde o app est√° rodando
- Executar `flutter run` quando j√° existe uma inst√¢ncia rodando

### ‚úÖ SOLU√á√ÉO:

**Para aplicar mudan√ßas de c√≥digo:**

1. Crie/modifique o arquivo
2. Informe ao usu√°rio: "Arquivo criado/modificado. O hot reload pode n√£o ocorrer automaticamente. Execute no VS Code: Salve o arquivo (Ctrl+S) ou use Shift+F5 + F5 para reiniciar."
3. **NUNCA** envie 'r' para o terminal

**Para testar mudan√ßas:**
```bash
# Sempre use um NOVO terminal (n√£o o do Flutter)
cd avisa_la
flutter run --debug --device-id=RQCW307SRFT
```

---

## üìã WORKFLOW PARA IA

### 1. CRIAR/MODIFICAR C√ìDIGO

```markdown
**Resposta da IA:**

Criei o arquivo `lib/features/nova_feature/nova_page.dart`.

**Pr√≥ximos passos:**
1. Se o app J√Å estiver rodando:
   - Pe√ßa ao usu√°rio para salvar o arquivo (Ctrl+S) no VS Code
   - Ou reiniciar o debug (Shift+F5 + F5)

2. Se o app N√ÉO estiver rodando:
   - Execute: `flutter run --debug --device-id=RQCW307SRFT`
```

### 2. EXECUTAR TESTES

```bash
# Sempre em novo terminal
cd avisa_la
flutter test test/caminho/do/teste.dart
```

### 3. ANALISAR C√ìDIGO

```bash
cd avisa_la
flutter analyze
```

### 4. FORMATAR C√ìDIGO

```bash
cd avisa_la
dart format lib/ test/ -l 80
```

### 5. BUILD APK

```bash
cd avisa_la
flutter build apk --debug
```

### 6. VER LOGS

```bash
# Em novo terminal
adb logcat | grep -i "flutter\|avisa"
```

---

## üéØ ESTRUTURA DO PROJETO

### Arquitetura:
- **Feature-first**: Cada feature em sua pasta
- **Provider**: State management
- **Navega√ß√£o padr√£o**: Flutter Navigator

### Estrutura:
```
lib/
‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îú‚îÄ‚îÄ home/              # Tela principal com mapa
‚îÇ   ‚îú‚îÄ‚îÄ search/            # Busca de destino (Google Places)
‚îÇ   ‚îú‚îÄ‚îÄ trip_monitoring/   # Monitoramento GPS em tempo real
‚îÇ   ‚îî‚îÄ‚îÄ alarm/             # Alarme quando pr√≥ximo ao destino
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ models/            # Destination, TripStatus
‚îÇ   ‚îú‚îÄ‚îÄ services/          # GPS, Notifications, Background
‚îÇ   ‚îî‚îÄ‚îÄ utils/             # Calculadores, constantes
‚îî‚îÄ‚îÄ main.dart
```

### Depend√™ncias Principais:
```yaml
provider: ^6.1.1              # State management
geolocator: ^14.0.2           # GPS
flutter_background_service    # Servi√ßo em segundo plano
flutter_local_notifications   # Notifica√ß√µes
google_maps_flutter: ^2.5.3   # Mapas
audioplayers: ^6.1.0          # Som de alarme
shared_preferences: ^2.2.2    # Storage local
```

---

## üîß COMANDOS √öTEIS PARA IA

### Verificar Dispositivo:
```bash
flutter devices
# Deve mostrar: SM S911B (RQCW307SRFT)
```

### Iniciar App (novo terminal):
```bash
cd avisa_la
flutter run --debug --device-id=RQCW307SRFT
```

### Parar App:
```bash
# N√£o envie 'q' para o terminal do Flutter!
# Instrua o usu√°rio: "Pressione Shift+F5 no VS Code"
```

### Ver Logs de Erros:
```bash
# Novo terminal
cd avisa_la
flutter logs

# Ou logs Android
adb logcat | grep -E "flutter|avisa|ERROR|FATAL"
```

### Limpar e Rebuildar:
```bash
cd avisa_la
flutter clean
flutter pub get
flutter run --debug --device-id=RQCW307SRFT
```

---

## üé® PADR√ïES DE C√ìDIGO

### Sempre use estes padr√µes:

**Imports (ordem obrigat√≥ria):**
```dart
// 1. Dart SDK
import 'dart:async';

// 2. Flutter SDK
import 'package:flutter/material.dart';

// 3. Pacotes externos
import 'package:provider/provider.dart';
import 'package:geolocator/geolocator.dart';

// 4. Imports locais
import 'package:avisa_la/core/models/destination.dart';
```

**Naming:**
- Classes: `PascalCase` ‚Üí `TripMonitoringPage`
- Arquivos: `snake_case` ‚Üí `trip_monitoring_page.dart`
- Vari√°veis: `camelCase` ‚Üí `destinationName`
- Constantes: `lowerCamelCase` ‚Üí `kDefaultAlertDistance`

**Widgets:**
```dart
class MyWidget extends StatelessWidget {
  const MyWidget({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: _buildAppBar(),
      body: _buildBody(),
    );
  }
  
  AppBar _buildAppBar() {
    return AppBar(title: const Text('T√≠tulo'));
  }
  
  Widget _buildBody() {
    return const Center(child: Text('Corpo'));
  }
}
```

---

## üì± DEVICE E AMBIENTE

### Device de Teste:
- **Samsung Galaxy S23** (SM-S911B)
- Device ID: `RQCW307SRFT`
- Conex√£o: USB
- Android 16 (API 36)

### Sistema:
- Pop!_OS 22.04
- Flutter 3.38.3
- Dart 3.10.1
- Bash shell

### Sempre use:
```bash
--device-id=RQCW307SRFT
# Ou simplesmente: --device-id=s23 (Flutter auto-detecta)
```

---

## üöÄ FEATURES DO APP AVISA L√Å

### 1. Background Service (GPS em segundo plano)
```dart
// Sempre verifique se est√° rodando antes
await BackgroundService.isRunning();
```

### 2. Geolocaliza√ß√£o
```dart
// Requer permiss√£o "Always" para background
final position = await GeolocationService.getCurrentPosition();
```

### 3. Notifica√ß√µes
```dart
// Sistema robusto com alta prioridade
await NotificationService.showAlarmNotification(
  title: 'Chegando!',
  body: 'Voc√™ est√° pr√≥ximo ao destino',
);
```

### 4. C√°lculo de Dist√¢ncia
```dart
// F√≥rmula de Haversine
final distance = DistanceCalculator.calculateDistance(
  lat1, lon1, lat2, lon2
);
```

---

## ‚ö†Ô∏è PERMISS√ïES ANDROID (CR√çTICO)

O app precisa destas permiss√µes:

```xml
<!-- AndroidManifest.xml -->
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_BACKGROUND_LOCATION" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE_LOCATION" />
<uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
```

---

## üí° PROCESSO COMPLETO DE DESENVOLVIMENTO COM IA

### Ciclo t√≠pico:

1. **IA cria/modifica c√≥digo:**
   ```
   "Criei lib/features/nova/nova_page.dart"
   ```

2. **IA formata:**
   ```bash
   cd avisa_la && dart format lib/features/nova/ -l 80
   ```

3. **IA analisa:**
   ```bash
   cd avisa_la && flutter analyze
   ```

4. **IA testa (se houver testes):**
   ```bash
   cd avisa_la && flutter test
   ```

5. **IA instrui usu√°rio:**
   ```
   "Se o app estiver rodando, salve o arquivo (Ctrl+S).
    Caso contr√°rio, execute: flutter run --debug --device-id=RQCW307SRFT"
   ```

6. **IA aguarda feedback do usu√°rio sobre comportamento no S23**

7. **IA corrige problemas baseado no feedback**

---

## üêõ DEBUG E TROUBLESHOOTING

### Quando h√° erro no app:

1. **IA pede logs:**
   ```
   "Por favor, copie e cole aqui os logs do terminal onde o Flutter est√° rodando"
   ```

2. **IA analisa erro**

3. **IA corrige o c√≥digo**

4. **IA formata novamente**

5. **IA instrui:**
   ```
   "Reinicie o app: Shift+F5 + F5 no VS Code"
   ```

### Para erros de GPS/Background:

```bash
# IA pode pedir logs espec√≠ficos do Android
adb logcat | grep -i "geolocator\|background\|permission"
```

---

## ‚úÖ CHECKLIST PARA IA ANTES DE RESPONDER

- [ ] Vou criar/modificar c√≥digo?
  - [ ] Formatei o c√≥digo? (`dart format`)
  - [ ] Analisei erros? (`flutter analyze`)
  - [ ] Instru√≠ sobre hot reload/restart?
  
- [ ] Vou executar comando?
  - [ ] √â em NOVO terminal (n√£o o do Flutter)?
  - [ ] Especifiquei `cd avisa_la`?
  - [ ] Inclui `--device-id=RQCW307SRFT` se necess√°rio?
  
- [ ] Vou pedir feedback?
  - [ ] Especifiquei O QUE testar no S23?
  - [ ] Pedi logs se necess√°rio?
  
- [ ] Preciso de logs?
  - [ ] Especifiquei qual comando executar?
  - [ ] Pedi para copiar/colar o output?

---

## üéØ OBJETIVO

**Desenvolvimento 100% assistido por IA, sem perder conex√£o do debug!**

- IA escreve todo o c√≥digo
- IA executa todos os comandos
- IA corrige todos os erros
- Usu√°rio apenas valida no S23
- Debug sempre conectado
- Hot reload quando poss√≠vel
- Feedback r√°pido e claro
